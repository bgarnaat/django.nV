# VULNERABILITY REPORT
## You are vulnerable.

**Reviewer 1:**  Ben Garnaat

**Reviewer 2:**  Joe McClenahan

**Date:**  April 99 2016

## Reviewing nVisium Task manager

### Vulnerability 1:

#### Exposure:

We found an instance of SQL Injection by typing "testPic',(select password from auth_user where username='admin'),8);--" into "File Name".

By Exploiting this vulnerability we were able to retrieve the hashed database admin password from the bug report error page.


#### Repair:

views.py contained the vulnerability.  We were able to fix the first with the following adjustment(s):

#### views.py

USE ORM.  NOT DIRECT SQL.

using the file model, set name, path, and project_id attributes to values accepted from form input.  call the .save() method on this file object to commit to db.

```
file = File(name=name, path=upload_path, project_id=proj)
file.save()

 ```


### Vulnerability 2:

#### Exposure:

We found an instance of Broken Auth by typing the form object in HTML contained all fields commented out (superuser & staff checkboxes).  Uncommenting this block of code allows us to become the most powerful hackers in the world (sorry Dade).

By Exploiting this vulnerability we were able to login with super user credentials.


#### Repair:

forms.py contained the vulnerability.  We were able to fix the vulnerability  with the following adjustment(s):

#### forms.py
explicitly declare the fields to accept input from the form
```
fields = ['username', 'password', 'first_name', 'last_name', 'email']
```


### Vulnerability 3:

#### Exposure:

We found an instance of XSS by updating username field of profile page to include <script> tags with JavaScript.

By Exploiting this vulnerability we were able to pop up an alert window on loading a page.  This could theoretically be used to mine the database for login information of other users with proper syntax.


#### Repair:

base_backend.html contained the vulnerability.  We were able to fix this with the following adjustment(s):

#### base_backend.html
```
remove |safe from template fields.
```


### Vulnerability 4:

#### Exposure:

We found an instance of insecure DOR by typing project id's into the URL bar e.g. adding 8/8 to taskManager --> taskManager/8/8/.

By Exploiting this vulnerability we were able to a different user's project!  TAKE THAT NEWS.  - Dade waz here.


#### Repair:

views.py contained one or two similar vulnerabilities (like 10).  We were able to fix at least one with the following adjustment(s):

#### views.py
Change:
```
if request.method == 'POST':

to

if request.method == 'POST' and user.is_authenticated():
```




### Vulnerability 5:

#### Exposure:

We found an instance of security misconfiguration (debug = True) by causing errors in previous security vulnerabilities.

By Exploiting this vulnerability we were able to retrieve db admin password from SQL injection from the site.  We were also able to debug the site.


#### Repair:

settings.py contained the vulnerability.  We were able to fix the first with the following adjustment(s):

#### settings.py
```
Debug = False
```


### Vulnerability 6:

#### Exposure:

We found an instance of Sensitive Data Exposure accessible through SQLinjection (in the debug screen) revealing the taskmanager hash algorithm as well as the db admin hashed password.  md5 appears to be an easily cracked hash which should be avoided like the plague.

By Exploiting this vulnerability we were able to retrieve hash algorithm (md5) and hashed password from the site.


#### Repair:

settings.py contained the vulnerability.  We were able to fix the first with the following adjustment(s):

#### settings.py
```
PASSWORD_HASHERS = ['django.contrib.auth.hashers.BCryptPasswordHasher']
```


### Vulnerability 7:

#### Exposure:

Using the insecure DOR vulnerability, we found an instance of Access vulnerability by typing project id's into the URL bar e.g. adding 8/8 to taskManager --> taskManager/8/8/.  Due missing user group authentication, we were able to delete another user's project that was not listed under projects Dade was authorized to see.


#### Repair:

views.py contained the vulnerability.  We were able to fix the vulnerability with the following adjustment(s):

#### views.py
Change:
```
if request.method == 'POST':

to

if request.method == 'POST' and user.has_perm('can_change_group'):
```


### Vulnerability 8:

#### Exposure:

We found an instance of CSRF by typing the address of a profile (insecure DOR), inspecting the form element, copy/pasting the form to a new file which was then saved as thishtml.html.  An important step is to ensure the form points to the original URL.  We then proceeded to open this file with a browser window and save the form.  This updated the stored values for the user on the actual site. Because there is no CSRF token we were able to save the form from outside of the application.


#### Repair:

views.py contained the vulnerability.  We were able to fix the first with the following adjustment(s):

#### views.py
```
removing @csrf_exempt decorator from anywhere it is located will help to protect a site and the userbase.
```
